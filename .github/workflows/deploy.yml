name: Deploy

on:
  workflow_dispatch:
  workflow_call:

jobs:
  dev:
    name: Development
    if: github.ref_name == 'debug'
    runs-on: ubuntu-latest
    steps:
      - name: generate vars
        shell: bash
        id: vars
        run: |
          webhooks=${{ secrets.CF_DEV_URL }}
          ref="${{ github.ref_name }}"

          if [[ $ref == 'main' ]]; then
            webhooks=${{ secrets.CF_PROD_URL }}
          fi

          echo "webhooks=${webhooks}" >> $GITHUB_OUTPUT

      - name: Deploy
        shell: bash
        run: |
          curl --request GET $WEBHOOKS --header 'Authorization: Bearer ${{ secrets.CF_API_TOKEN }}'
        env:
          WEBHOOKS: ${{ steps.vars.outputs.webhooks }}
